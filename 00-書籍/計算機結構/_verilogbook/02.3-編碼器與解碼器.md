### 2.3 編碼器與解碼器設計

編碼器和解碼器是數位系統中常用的組件，負責將數位信號進行編碼與解碼。它們廣泛應用於數位通信、數據壓縮、以及數位電路的多路輸入和輸出轉換。

#### 編碼器（Encoder）

編碼器的功能是將多個輸入信號（通常是 2 的 N 次方個）轉換為較少位數的二進位碼。簡單來說，編碼器的作用是根據哪個輸入信號被激活，生成對應的編碼。

例如，**優先編碼器（Priority Encoder）** 可以將 N 個輸入信號中的一個轉換成較少的輸出信號，並且具有優先級。在優先編碼器中，如果有多個輸入同時為 1，則優先考慮最高位的 1。

##### 優先編碼器（Priority Encoder）真值表：

| I3 | I2 | I1 | I0 | A1 | A0 | V |
|----|----|----|----|----|----|---|
|  0 |  0 |  0 |  0 |  0 |  0 | 0 |
|  0 |  0 |  0 |  1 |  0 |  0 | 1 |
|  0 |  0 |  1 |  0 |  0 |  1 | 1 |
|  0 |  0 |  1 |  1 |  0 |  1 | 1 |
|  0 |  1 |  0 |  0 |  1 |  0 | 1 |
|  0 |  1 |  0 |  1 |  1 |  0 | 1 |
|  0 |  1 |  1 |  0 |  1 |  1 | 1 |
|  0 |  1 |  1 |  1 |  1 |  1 | 1 |
|  1 |  0 |  0 |  0 |  1 |  0 | 1 |
|  1 |  0 |  0 |  1 |  1 |  0 | 1 |
|  1 |  0 |  1 |  0 |  1 |  1 | 1 |
|  1 |  0 |  1 |  1 |  1 |  1 | 1 |
|  1 |  1 |  0 |  0 |  1 |  0 | 1 |
|  1 |  1 |  0 |  1 |  1 |  0 | 1 |
|  1 |  1 |  1 |  0 |  1 |  1 | 1 |
|  1 |  1 |  1 |  1 |  1 |  1 | 1 |

這張真值表表明，當對應的輸入信號為 1 時，會生成對應的二進位碼（A1, A0），並且 **V** 是有效信號，指示哪一個輸入是有效的。

##### Verilog 程式碼（優先編碼器）

```verilog
module PriorityEncoder (
    input wire [3:0] I,     // 4位輸入信號
    output wire [1:0] A,    // 2位輸出編碼
    output wire V           // 輸出有效信號
);
    assign A = (I[3]) ? 2'b11 : 
               (I[2]) ? 2'b10 : 
               (I[1]) ? 2'b01 : 
               (I[0]) ? 2'b00 : 2'b00;
    
    assign V = |I; // 如果有任一輸入為1，則V為1，表示有效
endmodule
```

### 程式碼解釋：
1. **`PriorityEncoder` 模組**：此模組實現了優先編碼器，它有 4 個輸入 `I[3:0]`，以及 2 位輸出 `A[1:0]`，表示編碼結果。`V` 是有效信號，當任一輸入為 1 時，`V` 設為 1，表示存在有效輸入。

2. **編碼邏輯**：使用條件運算符 `? :` 來檢查哪些輸入為 1，並且根據優先級將對應的編碼值賦給 `A`。如果 `I[3]` 為 1，則 `A = 2'b11`；如果 `I[3]` 為 0，但 `I[2]` 為 1，則 `A = 2'b10`，以此類推。

3. **有效信號（V）**：通過位元運算 `|I`，如果 `I` 中有任意一位為 1，則 `V` 設為 1，表示有有效輸入。

#### 解碼器（Decoder）

解碼器的功能與編碼器相反，它的作用是將較少的輸入信號轉換為多位輸出信號。解碼器通常用於從較小的二進位編碼中恢復出完整的原始信號。

最常見的解碼器是 **二進位解碼器（Binary Decoder）**，如 2-to-4 解碼器，它有 2 個輸入和 4 個輸出。根據輸入的不同值，對應的輸出信號將被激活。

##### 2-to-4 解碼器真值表：

| A1 | A0 | Y3 | Y2 | Y1 | Y0 |
|----|----|----|----|----|----|
|  0 |  0 |  0 |  0 |  0 |  1 |
|  0 |  1 |  0 |  0 |  1 |  0 |
|  1 |  0 |  0 |  1 |  0 |  0 |
|  1 |  1 |  1 |  0 |  0 |  0 |

在此真值表中，`A1` 和 `A0` 是解碼器的輸入，而 `Y3` 到 `Y0` 是輸出的 4 個信號。根據輸入的二進位值，對應的輸出會被激活。

##### Verilog 程式碼（2-to-4 解碼器）

```verilog
module Decoder2to4 (
    input wire [1:0] A,    // 2位輸入信號
    output wire [3:0] Y    // 4位輸出信號
);
    assign Y = (A == 2'b00) ? 4'b0001 :
               (A == 2'b01) ? 4'b0010 :
               (A == 2'b10) ? 4'b0100 :
               (A == 2'b11) ? 4'b1000 : 4'b0000;
endmodule
```

### 程式碼解釋：
1. **`Decoder2to4` 模組**：此模組實現了一個 2-to-4 解碼器，接受 2 位二進位輸入 `A[1:0]`，並生成 4 位輸出 `Y[3:0]`，對應於不同的輸入組合。

2. **解碼邏輯**：通過條件運算符 `? :`，根據 `A` 的不同值設置 `Y` 的對應位。當 `A` 為 00 時，`Y = 4'b0001`；當 `A` 為 01 時，`Y = 4'b0010`，依此類推。

### 設計意義與原理：
1. **編碼器設計**：編碼器將多個輸入信號映射為較少的二進位表示。這種轉換在多路選擇器、數據壓縮和通信協定中具有重要的應用。優先編碼器特別有用，因為它會考慮哪些信號具有最高優先級。

2. **解碼器設計**：解碼器將較少的輸入信號轉換為多位輸出信號。解碼器在顯示驅動、記憶體地址選擇以及各種數位系統中都有重要作用。通過解碼器，可以實現更靈活的信號選擇與控制。

### 結論：
編碼器和解碼器是數位系統中不可或缺的組件。編碼器將多個輸入映射為簡短的編碼，而解碼器則將簡短的編碼轉換回完整的信號。這些元件在處理大量數據、信號轉換和地址選擇等方面起著重要作用。在設計中，理解這些元件的工作原理及其在數位邏輯中的應用是至關重要的。