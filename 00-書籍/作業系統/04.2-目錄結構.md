### 4.2 目錄結構

目錄結構（Directory Structure）是檔案系統中用來組織和管理檔案的一種方式。它類似於一個樹狀結構，其中檔案是葉節點，目錄是分支節點。這種結構可以讓使用者或程式更有效率地查找和管理檔案。作業系統通過目錄結構來確定檔案的位置，並提供給使用者清晰的檔案儲存和檢索方式。

#### 4.2.1 目錄的基本概念

目錄（Directory）是一個特殊的檔案，用來儲存檔案和其他目錄的名稱與對應的位置。它可以看作是一個檔案的索引，包含了檔案名稱和檔案的元資料（例如檔案的存儲位置、大小等）。目錄本身也可能包含其他目錄，因此目錄結構可以呈現層次化的形式。這樣的結構不僅幫助組織檔案，還能使系統在處理大量檔案時維持效率。

在一般的作業系統中，目錄會被表示為一個特殊的檔案，其中包含了所有該目錄下的檔案名稱和對應的資料位置。每個目錄項通常包含兩個部分：
1. **檔案名稱**：檔案或目錄的名稱。
2. **檔案位址**：檔案存儲位置的指標，這通常是該檔案在存儲設備中的物理地址或其在磁碟上的相對位址。

#### 4.2.2 目錄的層次結構

目錄結構通常是層次化的，這樣的結構可以將檔案按類別、用途或使用者需求進行分類。目錄結構的最上層稱為根目錄（Root Directory），根目錄包含所有其他目錄和檔案。根目錄以下的目錄可以再進一步包含子目錄，形成一個樹狀結構。

例如，對於一個類似 UNIX 系統的作業系統，其目錄結構可能如下所示：

```
/
├── home
│   ├── user1
│   ├── user2
│   └── user3
├── bin
│   ├── ls
│   ├── cp
│   └── mv
├── etc
│   ├── passwd
│   ├── fstab
│   └── network
└── var
    ├── log
    ├── spool
    └── temp
```

- **根目錄 `/`** 是目錄結構的最上層，所有其他檔案和目錄都位於根目錄下。
- **子目錄** 例如 `home`、`bin`、`etc` 和 `var` 分別包含了用戶資料、執行檔案、配置檔案和系統資源等。
- 每個子目錄下還可以包含更多的子目錄或檔案。

這樣的層次結構使得檔案系統更加有組織，也讓使用者能夠輕鬆地找到所需的檔案。

#### 4.2.3 目錄的類型

目錄結構可以根據作業系統的設計選擇不同的結構方式。常見的目錄類型包括：

- **單層目錄結構**：所有檔案都儲存在一個目錄中，這種結構非常簡單，但在處理大量檔案時效率較低，且不易進行管理。
  
  例如：
  ```
  /
  ├── file1
  ├── file2
  ├── file3
  └── file4
  ```

- **多層目錄結構**：使用多層目錄來儲存檔案，這是目前大多數作業系統使用的結構。它支持將檔案按照不同類別、用途進行分類，並可以避免單一目錄過於擁擠。
  
  例如：
  ```
  /
  ├── documents
  │   ├── report.txt
  │   └── notes.txt
  ├── pictures
  │   ├── photo1.jpg
  │   └── photo2.jpg
  └── music
      ├── song1.mp3
      └── song2.mp3
  ```

- **樹狀目錄結構**：這是一種更加復雜且具有多層次的結構，每個目錄下面都可以有自己的子目錄和檔案，並且允許檔案和目錄之間建立父子關係。這種結構通常使用在 UNIX 和 Linux 等作業系統中。
  
  例如：
  ```
  /
  ├── usr
  │   ├── bin
  │   ├── lib
  │   └── include
  ├── home
  │   ├── user1
  │   └── user2
  └── var
      ├── log
      ├── spool
      └── temp
  ```

#### 4.2.4 目錄項的操作

對於目錄的操作通常包括以下幾個主要操作：

- **創建目錄（mkdir）**：用於在檔案系統中創建新的目錄。用戶可以通過此操作來建立新的子目錄。
- **刪除目錄（rmdir）**：用於刪除空的目錄。若目錄中還包含檔案或子目錄，則需先刪除其內容或移動至其他地方，才能刪除該目錄。
- **列出目錄內容（ls）**：用於列出指定目錄中的所有檔案和子目錄。
- **改變目錄（cd）**：用戶可以使用此操作切換當前工作目錄，讓作業系統了解當前在哪個目錄中進行操作。
- **檢查目錄層次（stat）**：用來檢查目錄的元資料，例如檔案的大小、創建時間和修改時間。

#### 4.2.5 目錄的存取控制

目錄通常會有存取控制機制，這樣能夠限制哪些用戶或進程可以對目錄中的檔案進行操作。作業系統可以對每個目錄設置權限，包括：
- **讀取權限**：允許用戶查看目錄內容。
- **寫入權限**：允許用戶在目錄中創建、刪除或修改檔案。
- **執行權限**：允許用戶進入該目錄，並能夠在其中執行操作。

作業系統通過這些權限來保護目錄中的資料不被未授權的用戶訪問或修改。

#### 小結

目錄結構是檔案系統中至關重要的一部分，它幫助系統高效地組織和管理大量檔案。通過層次化的目錄結構，使用者可以更方便地找到所需檔案，同時作業系統也能高效地維護檔案存儲。在設計目錄結構時，合理的層次和清晰的分類能夠提高系統的可擴展性和易用性。