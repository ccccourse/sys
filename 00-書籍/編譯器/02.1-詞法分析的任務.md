### 2.1 詞法分析的任務

詞法分析（Lexical Analysis），又稱為詞法掃描，是編譯過程中的第一個階段。它的主要任務是將源程式的原始字符流轉換為一組有意義的記號（Token），為後續的語法分析提供基礎。詞法分析不僅僅是對字符的簡單解析，它還需要對程序中的結構進行識別，從而識別出不同語言元素的語法單位，如關鍵字、變量名、常數、操作符等。

#### 詞法分析的主要任務包括：

1. **將源程式分割成記號**：
   - 程式的源代碼通常由一系列字符組成，這些字符本身並不具備語法意義。詞法分析的首要任務是將源程式中的字符序列轉換為一系列記號（tokens），這些記號是語法分析的基本單位。每個記號表示一個語言元素，例如數字、標識符、關鍵字、操作符等。
   
   例如，對於以下代碼：
   ```c
   int x = 10 + 20;
   ```
   詞法分析會將其分割成如下記號：
   - `int`（關鍵字）
   - `x`（標識符）
   - `=`（賦值運算符）
   - `10`（整數常數）
   - `+`（加法運算符）
   - `20`（整數常數）
   - `;`（分號，語句結束符）

2. **識別標識符和關鍵字**：
   - 在高級語言中，標識符（如變量名、函數名）和關鍵字（如 `if`、`while`、`int` 等）是最基本的語言單元。詞法分析的任務之一是識別這些記號並區分它們。標識符一般由字母和數字組成，而關鍵字是語言中預定義的特殊單詞，具有特定語義。
   
   例如，在 C 語言中，`int` 是關鍵字，`x` 是標識符。

3. **處理數字和字串常數**：
   - 程式中常常包含數字和字串常數，這些常數也需要在詞法分析中被識別並轉換為相應的記號。例如，數字 `10` 會被轉換為 `INTEGER_LITERAL`，字串 `"hello"` 會被轉換為 `STRING_LITERAL`。

4. **識別操作符和分隔符**：
   - 操作符（如 `+`、`-`、`*` 等）和分隔符（如括號 `()`、分號 `;` 等）是語言中非常重要的結構。詞法分析需要識別並將這些符號轉換為相應的記號。
   
   例如，對於表達式 `a + b`，詞法分析會生成 `a`（標識符）、`+`（操作符）、`b`（標識符）等記號。

5. **處理註解和空白字符**：
   - 程式語言中通常會包含註解和空白字符（如空格、換行符），這些字符對語言的語法結構沒有影響，因此通常會被詞法分析器忽略。然而，註解和空白字符的處理是詞法分析的重要部分，因為它們在源代碼中扮演著可讀性和格式化的角色。
   
   例如，C 語言中的註解 `/* This is a comment */` 會被詞法分析器忽略，且不會產生任何記號。

6. **錯誤處理**：
   - 詞法分析還負責處理一些語法錯誤。例如，當遇到非法字符或不符合語言語法規則的部分時，詞法分析器需要能夠發現錯誤並報告給用戶。這些錯誤可以是拼寫錯誤、非法字符或語法錯誤。
   
   例如，對於無效的標識符 `$var`，詞法分析器應該識別出錯誤，並向使用者報告問題。

#### 詞法分析的工作流程
詞法分析的具體工作流程通常包括以下幾個步驟：
1. **讀取源代碼**：詞法分析器從源代碼中逐字讀取字符。
2. **分組字符**：將相鄰的字符組成有意義的記號，識別出標識符、數字、運算符等語言元素。
3. **生成記號**：每個識別出的語言元素都會轉換為對應的記號，每個記號會被標記為特定類型，如 `IDENTIFIER`、`INTEGER_LITERAL` 等。
4. **傳遞給語法分析器**：詞法分析器將生成的記號序列傳遞給語法分析器，進行後續的語法分析。

### 小結
詞法分析是編譯過程中至關重要的一步，它負責將源代碼的字符流轉換為結構化的記號序列，為語法分析等後續步驟奠定基礎。詞法分析的任務包括識別並處理語言中的各種語法單位，如標識符、數字、關鍵字、操作符等，並將它們轉換為相應的記號。這一過程不僅涉及字符的識別，還包括對錯誤的檢測和處理，是編譯器能夠正確解析程序語言的第一步。