### 1.1 什麼是編譯器

編譯器是一種將高階程式語言的源代碼轉換為目標機器碼的軟體工具。高階語言（如 C、C++、Java、Python 等）是一種靠近人類語言的程式設計語言，其主要目的是提升程式設計的可讀性和開發效率。然而，計算機的中央處理器（CPU）無法直接理解這些高階語言，只能執行用機器語言（低階語言）編寫的指令。這些指令通常由二進制數字組成，具備高度的精確性，但對人類來說難以直接編寫和理解。

編譯器的角色就是充當高階語言和低階機器碼之間的轉換橋樑，將人類編寫的源代碼轉換為可以被機器直接執行的二進制指令碼。這個轉換過程稱為「編譯」，而整個編譯過程則涉及多個關鍵階段。

#### 編譯器的主要功能

1. **語法檢查**：
    - 編譯器首先會對源代碼進行語法檢查，這是為了確保程式碼符合語言的語法規則。
    - 語法檢查通常包括詞法分析和語法分析，目的是找出源代碼中的語法錯誤，例如缺少分號、未關閉的括號或不匹配的語法結構等。
  
2. **詞法分析（Lexical Analysis）**：
    - 在這一階段，編譯器將源代碼分解成為一系列的詞法單元（token），這些單元是源代碼中具有語法意義的最小單位。
    - 例如，在 C 語言中，`int a = 5;` 可以分解為詞法單元：`int`（關鍵字）、`a`（標識符）、`=`（賦值運算符）、`5`（常數）和`;`（分號）。

3. **語法分析（Syntax Analysis）**：
    - 編譯器使用詞法分析的結果生成一棵語法樹（syntax tree），語法樹是源代碼結構的一種樹形表示法。
    - 語法分析確保源代碼的結構符合語言的語法規則，例如確保每個函數的定義中都有一個返回類型和一個名稱。

4. **語義分析（Semantic Analysis）**：
    - 語義分析的目的是檢查語法樹是否具有語義上的正確性，例如類型檢查（type checking）和變量範疇分析（scope analysis）。
    - 這個階段可以檢查類型不匹配的錯誤，如將整數類型的變數賦值給布爾類型的變數。

5. **中間代碼生成（Intermediate Code Generation）**：
    - 編譯器將語法樹轉換為一種中間表示（intermediate representation, IR），這種表示形式介於高階語言和機器碼之間，常用的形式有三地址碼（Three Address Code）和靜態單賦值形式（Static Single Assignment, SSA）。
    - 中間代碼提供了一種抽象層，方便編譯器在不同的目標機器上進行優化和轉換。

6. **程式最佳化（Optimization）**：
    - 編譯器對中間代碼進行優化，以提升程式的執行效率或減少資源消耗。
    - 優化可以是局部的（local optimization），如去除不必要的指令，或全域的（global optimization），如循環優化和常量折疊。

7. **目標代碼生成（Code Generation）**：
    - 在最終階段，編譯器將優化後的中間代碼轉換為目標機器的機器碼，這包括指令選擇、暫存器分配和指令排程。
    - 最終生成的機器碼通常以可執行文件的形式輸出，可以直接在目標機器上運行。

8. **錯誤處理（Error Handling）**：
    - 編譯器在各個階段都可能遇到錯誤，從語法錯誤到語義錯誤。
    - 高效的錯誤處理機制能夠幫助開發者快速定位和修復代碼中的問題，提高開發效率。

現代編譯器不僅僅是一個簡單的翻譯工具，還能進行複雜的優化，從而生成高效的機器碼。隨著計算機技術的發展，編譯器的應用範圍也不斷擴大，涵蓋了數據分析、圖形渲染、嵌入式系統等多個領域。編譯器技術已經成為計算機科學和軟體工程領域的一個核心組成部分。